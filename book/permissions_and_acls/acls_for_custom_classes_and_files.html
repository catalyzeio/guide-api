<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>ACLs for Custom Classes and Files | Catalyze BaaS Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="catalyzeio">
    
    
    <link rel="next" href="../permissions_and_acls/managing_groups.html" />
    
    
    <link rel="prev" href="../permissions_and_acls/create_a_custom_class_entry_for_another_user.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-github="catalyzeio/guide-api" data-level="7.3" data-basepath=".." data-revision="1402499165483">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/catalyzeio/guide-api" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/catalyzeio/guide-api/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/catalyzeio/guide-api/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Catalyze BaaS Guide</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/catalyzeio" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/catalyzeio/guide-api/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/catalyzeio/guide-api/edit/master/permissions_and_acls/acls_for_custom_classes_and_files.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="getting_started/README.html">
            
            <a href="../getting_started/README.html">
                <i class="fa fa-check"></i> <b>1.</b> Getting Started
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="organizations_and_applications/README.html">
            
            <a href="../organizations_and_applications/README.html">
                <i class="fa fa-check"></i> <b>2.</b> Organizations and Applications
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="managing_users/README.html">
            
            <a href="../managing_users/README.html">
                <i class="fa fa-check"></i> <b>3.</b> Managing Users and Roles
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="file_management/README.html">
            
            <a href="../file_management/README.html">
                <i class="fa fa-check"></i> <b>4.</b> File Management
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="custom_classes/README.html">
            
            <a href="../custom_classes/README.html">
                <i class="fa fa-check"></i> <b>5.</b> Building Custom Classes
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="querying_custom_classes/README.html">
            
            <a href="../querying_custom_classes/README.html">
                <i class="fa fa-check"></i> <b>6.</b> Querying Custom Classes
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="permissions_and_acls/README.html">
            
            <a href="../permissions_and_acls/README.html">
                <i class="fa fa-check"></i> <b>7.</b> Permissions and ACLs
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="permissions_and_acls/create_a_file_for_another_user.html">
            
            <a href="../permissions_and_acls/create_a_file_for_another_user.html">
                <i class="fa fa-check"></i> <b>7.1.</b> Create a File for Another User
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="permissions_and_acls/create_a_custom_class_entry_for_another_user.html">
            
            <a href="../permissions_and_acls/create_a_custom_class_entry_for_another_user.html">
                <i class="fa fa-check"></i> <b>7.2.</b> Create a Custom Class Entry for Another User
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="permissions_and_acls/acls_for_custom_classes_and_files.html">
            
            <a href="../permissions_and_acls/acls_for_custom_classes_and_files.html">
                <i class="fa fa-check"></i> <b>7.3.</b> ACLs for Custom Classes and Files
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="permissions_and_acls/managing_groups.html">
            
            <a href="../permissions_and_acls/managing_groups.html">
                <i class="fa fa-check"></i> <b>7.4.</b> Managing Groups
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="clinical_data_models/README.html">
            
            <a href="../clinical_data_models/README.html">
                <i class="fa fa-check"></i> <b>8.</b> Clinical Data Models
            </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 83.33333333333333%;min-width: 75%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../getting_started/README.html" title="Getting Started" class="chapter done new-chapter" data-progress="1" style="left: 8.333333333333334%;"></a>
    
        <a href="../organizations_and_applications/README.html" title="Organizations and Applications" class="chapter done new-chapter" data-progress="2" style="left: 16.666666666666668%;"></a>
    
        <a href="../managing_users/README.html" title="Managing Users and Roles" class="chapter done new-chapter" data-progress="3" style="left: 25%;"></a>
    
        <a href="../file_management/README.html" title="File Management" class="chapter done new-chapter" data-progress="4" style="left: 33.333333333333336%;"></a>
    
        <a href="../custom_classes/README.html" title="Building Custom Classes" class="chapter done new-chapter" data-progress="5" style="left: 41.666666666666664%;"></a>
    
        <a href="../querying_custom_classes/README.html" title="Querying Custom Classes" class="chapter done new-chapter" data-progress="6" style="left: 50%;"></a>
    
        <a href="../permissions_and_acls/README.html" title="Permissions and ACLs" class="chapter done new-chapter" data-progress="7" style="left: 58.333333333333336%;"></a>
    
        <a href="../permissions_and_acls/create_a_file_for_another_user.html" title="Create a File for Another User" class="chapter done " data-progress="7.1" style="left: 66.66666666666667%;"></a>
    
        <a href="../permissions_and_acls/create_a_custom_class_entry_for_another_user.html" title="Create a Custom Class Entry for Another User" class="chapter done " data-progress="7.2" style="left: 75%;"></a>
    
        <a href="../permissions_and_acls/acls_for_custom_classes_and_files.html" title="ACLs for Custom Classes and Files" class="chapter done " data-progress="7.3" style="left: 83.33333333333333%;"></a>
    
        <a href="../permissions_and_acls/managing_groups.html" title="Managing Groups" class="chapter  " data-progress="7.4" style="left: 91.66666666666667%;"></a>
    
        <a href="../clinical_data_models/README.html" title="Clinical Data Models" class="chapter  new-chapter" data-progress="8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_13">
                    
                        <h1 id="acls-for-custom-classes-and-files">ACLs for Custom Classes and Files</h1>
<p>In this section, we will manipulate the access control lists (ACLs) within ExampleApp to allow a regular user, Bob, to perform various operations against other users that would otherwise be impossible with default permissions. In the case of a regular user like Bob, the only data that he can manipulate (create, read, update or delete - or CRUD) by default is data he created originally, or that has been shared with him by another user, as in the previous two sections. This section shows how we can leverage ACLs to provide users with additional permissions within the application.</p>
<p>Values needed to run this example:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>adminApiKey</em></td>
<td>The transient API key for ExampleApp from calling <strong>/auth/all</strong> (see &quot;Get an Admin-level Session token and API Key&quot; under &quot;Getting Started&quot;)</td>
</tr>
<tr>
<td><em>adminSessionToken</em></td>
<td>The session token from <strong>/auth/all</strong></td>
</tr>
<tr>
<td><em>apiKey</em></td>
<td>The API key for ExampleApp</td>
</tr>
<tr>
<td><em>aliceSessionToken</em></td>
<td>a valid session token for Alice obtained from logging in using <em>apiKey</em></td>
</tr>
<tr>
<td><em>bobSessionToken</em></td>
<td>a valid session token for Bob obtained from logging in using <em>apiKey</em></td>
</tr>
<tr>
<td><em>aliceUsersId</em></td>
<td>Alice&#39;s <em>usersId</em>, obtained when signing Alice in to ExampleApp</td>
</tr>
<tr>
<td><em>bobUsersId</em></td>
<td>Bob&#39;s <em>usersId</em>, obtained when signing Bob in to ExampleApp</td>
</tr>
</tbody>
</table>
<p>Within an application, a user can have create, read, update and delete permissions (CRUD) within files and custom classes.</p>
<p>Here is a summary of the permission types:</p>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>create</em></td>
<td>The ability to create data across the application.</td>
</tr>
<tr>
<td><em>read</em></td>
<td>The ability to read data across the application. Can list and query data items as well.</td>
</tr>
<tr>
<td><em>update</em></td>
<td>The ability to update any data item within the application.</td>
</tr>
<tr>
<td><em>delete</em></td>
<td>The ability to delete any data item within the application.</td>
</tr>
</tbody>
</table>
<h2 id="granting-create-on-files">Granting Create on Files</h2>
<p>In <a href="create_a_file_for_another_user.html">section 7.1</a>, Bob attempted to upload a file to Alice but failed. To make this work, the application administrator can grant Bob create permission on files within the application.</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X POST https://api.catalyze.io/v2/acl/core/files/&lt;bobUsersId&gt; -d &#39;[&quot;create&quot;]&#39;
</code></pre><p>Bob can now create a file for Alice:</p>
<pre><code>curl -F &quot;phi=true&quot; -F &quot;file=@/Users/uphoff/Desktop/img.png&quot; -H &quot;X-Api-Key: &lt;apiKy&gt;&quot; -H &quot;Authorization: Bearer &lt;bobSessionToken&gt;&quot; -X POST https://api.catalyze.io/v2/users/&lt;aliceUsersId&gt;/files
</code></pre><p>The drawback here is that Bob can now create files for <strong>any</strong> user, not just Alice. An upcoming release will allow entity-level permission granting, allowing Alice to grant Bob, and only Bob, the ability to create files against herself.</p>
<p>The key concept here is that ACLs currently function at the <strong>model</strong> level within an application. Currently a model is either a custom class or a file. If a user has been granted a permission on a model it is valid only for that model. We will be extending ACLs to our clinical data models (medications, problems, procedures, etc) in time.</p>
<h2 id="granting-full-permissions-on-files">Granting Full Permissions on Files</h2>
<p>If we wanted to give Bob full control over files within the application we could extend his permissions to include read, update and delete permissions.</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X POST https://api.catalyze.io/v2/acl/core/files/&lt;bobUsersId&gt; -d &#39;[&quot;read&quot;,&quot;update&quot;,&quot;delete&quot;]&#39;
</code></pre><p>Bob now can perform any operation against any other user&#39;s files within the application.</p>
<h2 id="granting-full-permissions-on-a-custom-class">Granting Full Permissions on a Custom Class</h2>
<p>Granting permission against specific custom classes is also possible. The route is changes slightly (<strong>/core/files</strong> becomes <strong>/custom/&lt;className&gt;</strong>) but otherwise the call is the same:</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X POST https://api.catalyze.io/v2/acl/custom/ExampleClass/&lt;bobUsersId&gt; -d &#39;[&quot;create&quot;,&quot;read&quot;,&quot;update&quot;,&quot;delete&quot;]&#39;
</code></pre><p>The above call results in Bob having full permissions against the custom class named ExampleClass.</p>
<h2 id="revoking-acls-on-files">Revoking ACLs on Files</h2>
<p>Revoking ACLs is a matter of simply changing the POST from the above examples into a DELETE. The following command will revoke Bob&#39;s create permissions on files.</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X DELETE https://api.catalyze.io/v2/acl/core/files/&lt;bobUsersId&gt; -d &#39;[&quot;create&quot;]&#39;
</code></pre><p>Revoke the remaidner of the permissions with this command:</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X DELETE https://api.catalyze.io/v2/acl/core/files/&lt;bobUsersId&gt; -d &#39;[&quot;create&quot;,&quot;read&quot;,&quot;update&quot;,&quot;delete&quot;]&#39;
</code></pre><p>After running the above commands Bob is back to having default permissions on files. He can only manipulate his own data however any files that he created while he held create permissions will still be accessible to him.</p>
<h2 id="revoking-acls-on-custom-classes">Revoking ACLs on Custom Classes</h2>
<p>Revoking permissions on ExampleClass is almost the same as revoking file permissions, aside from a few changes to the route:</p>
<pre><code>curl -H &quot;X-Api-Key: &lt;adminApiKey&gt;&quot; -H &quot;Authorization: Bearer &lt;adminSessionToken&gt;&quot; -H &quot;Content-Type: application/json&quot; -X DELETE https://api.catalyze.io/v2/acl/custom/ExampleClass/&lt;bobUsersId&gt; -d &#39;[&quot;create&quot;,&quot;read&quot;,&quot;update&quot;,&quot;delete&quot;]&#39;
</code></pre>
                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../permissions_and_acls/create_a_custom_class_entry_for_another_user.html" class="navigation navigation-prev " aria-label="Previous page: Create a Custom Class Entry for Another User"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../permissions_and_acls/managing_groups.html" class="navigation navigation-next " aria-label="Next page: Managing Groups"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
